<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <!--
        用于登入    
    -->
    <input id="login" type="button" value="login" />
    <script>        
        //调用/connect/token登入,并保存token
    </script>
    <script>
        //假设跳过来的url是：/login.html?redirect_uri=http://www.baidu.com&callback=true
        function GetQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }
        document.getElementById("login").addEventListener(function (e) {
            $.ajax({
                url: "/connect/token",
                data: {
                    client_id: "client1",
                    grant_type: "myGrant"
                },
                dataType: "form-data",
                success: function (res) {
                    localStorage.setItem('access_token', res.data.access_token);
                    if (GetQueryString('callback') == 'true') {
                        var redirect_uri = GetQueryString('?redirect_uri');
                        window.location.href = "/callback.html?redirect_uri=" + "redirect_uri";
                    }
                }
            });
        });
    </script>
</body>
</html>