<from>
    <input id="username" name="username" value="admin" type="text" /><br />
    <input id="password" name="password" value="123" type="text" /><br />
    <input id="login" type="submit" value="login" />
</from>

<script type="text/javascript">
    function toUrl(data) {
        var buffer = '';
        for (var key in data) {
            buffer += key + '=' + data[key] + '&';
        }
        return buffer;
    }
    document.getElementById('login').addEventListener('click', async function () {
        var username = document.getElementById('username').value;
        var password = document.getElementById('password').value;
        var data = {
            client_id: "idp",
            grant_type: "password",
            username: username,
            password: password
        };

        var response = await fetch('/connect/token', {
            method: 'post',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: toUrl(data)
        });

        var json = await response.json();
        console.log(json);
        if (response.status != 200) {
            alert(json.error_description);
        }
        else {
            await fetch('/account/login', {
                headers: {
                    "Authorization": 'Bearer ' + json.access_token
                },
                method: 'post'
            });
        }
        //如果成功跳转到/Account/Login
    });
</script>